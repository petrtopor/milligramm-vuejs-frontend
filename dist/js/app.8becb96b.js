(function(t){function e(e){for(var n,o,r=e[0],c=e[1],l=e[2],u=0,g=[];u<r.length;u++)o=r[u],i[o]&&g.push(i[o][0]),i[o]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);d&&d(e);while(g.length)g.shift()();return a.push.apply(a,l||[]),s()}function s(){for(var t,e=0;e<a.length;e++){for(var s=a[e],n=!0,o=1;o<s.length;o++){var c=s[o];0!==i[c]&&(n=!1)}n&&(a.splice(e--,1),t=r(r.s=s[0]))}return t}var n={},i={app:0},a=[];function o(t){return r.p+"js/"+({about:"about"}[t]||t)+"."+{about:"8253d450"}[t]+".js"}function r(e){if(n[e])return n[e].exports;var s=n[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.e=function(t){var e=[],s=i[t];if(0!==s)if(s)e.push(s[2]);else{var n=new Promise(function(e,n){s=i[t]=[e,n]});e.push(s[2]=n);var a,c=document.createElement("script");c.charset="utf-8",c.timeout=120,r.nc&&c.setAttribute("nonce",r.nc),c.src=o(t),a=function(e){c.onerror=c.onload=null,clearTimeout(l);var s=i[t];if(0!==s){if(s){var n=e&&("load"===e.type?"missing":e.type),a=e&&e.target&&e.target.src,o=new Error("Loading chunk "+t+" failed.\n("+n+": "+a+")");o.type=n,o.request=a,s[1](o)}i[t]=void 0}};var l=setTimeout(function(){a({type:"timeout",target:c})},12e4);c.onerror=c.onload=a,document.head.appendChild(c)}return Promise.all(e)},r.m=t,r.c=n,r.d=function(t,e,s){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(s,n,function(e){return t[e]}.bind(null,n));return s},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/",r.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var d=l;a.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"03a5":function(t,e,s){},1:function(t,e){},"56d7":function(t,e,s){"use strict";s.r(e);s("cadf"),s("551c"),s("f751"),s("097d");var n=s("2b0e"),i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("router-view")],1)},a=[],o=(s("5c0b"),s("2877")),r={},c=Object(o["a"])(r,i,a,!1,null,null,null),l=c.exports,u=s("8c4f"),d=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[s("router-view")],1)},g=[],f={name:"home",data:function(){return{testData:"Vagiz"}}},m=f,v=(s("f7c3"),Object(o["a"])(m,d,g,!1,null,"26bbd593",null)),p=v.exports,h=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[s("div",{staticClass:"login_head_bg"}),s("div",{staticClass:"login_page"},[s("div",{staticClass:"head"},[t._m(0),s("div",{staticClass:"submit"},[s("div",{staticClass:"content",on:{click:t.onSubmitClick}},[s("span",[t._v("Next")]),s("div",{staticClass:"icon-next-submit"})])])]),s("div",{staticClass:"form"},[s("div",{staticClass:"content"},[s("h3",[t._v("Sign in")]),s("p",[t._v("Please choose your country and enter your full phone number.")]),s("div",{staticClass:"phone-input-group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],attrs:{placeholder:"Username"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})])])]),s("div",{staticClass:"footer"})])])},C=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"logo"},[s("div",{staticClass:"content"},[s("div",{staticClass:"icon"}),s("span",[t._v("Milligramm")])])])}],b={name:"Login",data:function(){return{username:""}},methods:{onSubmitClick:function(){var t=this;this.$store.dispatch("logIn",this.username).then(function(){t.$router.push({path:"im"})})}},watch:{username:function(t){this.$store.dispatch("setUsername",t)}}},L=b,D=(s("9ef7"),Object(o["a"])(L,h,C,!1,null,"1df84b54",null)),M=D.exports,k=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[s("div",{staticClass:"centered"},[s("div",{staticClass:"im-head"},[s("div",{staticClass:"logo"},[s("div",{staticClass:"btn"},[t._m(0),s("div",{staticClass:"caption"},[s("span",[t._v("Milligramm  === "+t._s(t.username))])])])]),t._m(1)]),s("div",{staticClass:"im-content"},[s("div",{staticClass:"dialogs"},[s("div",{staticClass:"search-panel"},[s("div",{staticClass:"search"},[s("div",{staticClass:"icon"}),s("model-select",{attrs:{options:t.options,placeholder:"select item"},model:{value:t.item,callback:function(e){t.item=e},expression:"item"}})],1)]),s("div",{staticClass:"dialogs-list"},t._l(t.dialogs,function(e){return s("Dialog",{attrs:{dialog:e,selected:e.dialogId===t.currentDialogId},on:{select:t.onDialogSelect}})}),1)]),s("div",{staticClass:"history"},[s("div",{staticClass:"messages-list"},t._l(t.messages,function(t){return s("Message",{attrs:{text:t.text,sender:t.author}})}),1),s("div",{staticClass:"panel"},[s("div",{staticClass:"content"},[t._m(2),s("div",{staticClass:"send-form"},[s("div",{staticClass:"textarea"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.draftMessage,expression:"draftMessage"}],domProps:{value:t.draftMessage},on:{input:function(e){e.target.composing||(t.draftMessage=e.target.value)}}})]),s("div",{staticClass:"buttons"},[s("div",{staticClass:"send-button",on:{click:t.sendMessage}},[s("span",[t._v("SEND")])])])]),t._m(3)])])])])])])},w=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"icon"},[s("div",{staticClass:"bar"}),s("div",{staticClass:"bar"}),s("div",{staticClass:"bar"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"main"},[s("div",{staticClass:"title"},[s("div",{staticClass:"dialog_info"},[s("span",{staticClass:"dialog_name"},[t._v("Telegram")]),s("span",{staticClass:"dialog_status"},[t._v("service notifications")])])]),s("div",{staticClass:"search-button"},[s("div",{staticClass:"icon"})]),s("div",{staticClass:"dropdown-button"},[s("div",{staticClass:"icon"},[s("div",{staticClass:"dot"}),s("div",{staticClass:"dot"}),s("div",{staticClass:"dot"})])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"userpic"},[s("div",{staticClass:"img"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"userpic"},[s("div",{staticClass:"img"})])}],x=(s("2ef0"),s("0393")),S=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"message"},[t._m(0),s("div",{staticClass:"content"},[s("div",{staticClass:"sender"},[s("span",[t._v(t._s(t.senderUsername))])]),s("div",{staticClass:"text"},[s("p",[t._v(t._s(t.text))])])]),s("div",{staticClass:"time"})])},$=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"icons"},[s("div",{staticClass:"container"},[s("div",{staticClass:"selection-marker"}),s("div",{staticClass:"img"})])])}],y={name:"Message",props:{sender:String,text:String},computed:{senderUsername:function(){var t=this;return this.$store.getters.usersList.filter(function(e){return e.socketId===t.sender})[0].username}}},I=y,O=(s("892b"),Object(o["a"])(I,S,$,!1,null,"7307ee6a",null)),j=O.exports,E=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"dialog-container",class:{selected:t.selected},on:{click:t.onDialogSelect}},[s("div",{staticClass:"content"},[s("div",{staticClass:"icon"}),s("div",{staticClass:"message"},[s("div",{staticClass:"caption"},[s("span",[t._v(t._s(t.caption))])]),s("div",{staticClass:"last-message"},[s("span",[t._v(t._s(t.lastMessage))])])]),s("div",{staticClass:"time"},[s("span",[t._v(t._s(t.time))])])])])},U=[],P=(s("6b54"),s("75fc")),N={name:"Dialog",data:function(){return{testData:!1}},props:{dialog:Object,selected:Boolean},computed:{caption:function(){var t=this;return this.dialog.usersList.map(function(e){return t.$store.getters.usersList.filter(function(t){return t.socketId===e})[0].username}).reduce(function(t,e){return t+" - "+e})},lastMessage:function(){var t=this,e=this.$store.getters.messagesOfDialog(this.dialog.dialogId).filter(function(e){return e.timestamp===Math.max.apply(Math,Object(P["a"])(t.$store.getters.messagesOfDialog(t.dialog.dialogId).map(function(t){return t.timestamp})))})[0].text;return e.length>22?e.substring(0,16)+"...":e},time:function(){var t=new Date(Math.max.apply(Math,Object(P["a"])(this.$store.getters.messagesOfDialog(this.dialog.dialogId).map(function(t){return t.timestamp}))));return t.getHours()+":"+(1===t.getMinutes().toString().length?"0"+t.getMinutes():t.getMinutes())+":"+t.getSeconds()}},methods:{onDialogSelect:function(){console.log("Dialog::onDialogSelect("+this.dialog.dialogId+")"),this.$emit("select",this.dialog.dialogId)}}},T=N,A=(s("f545"),Object(o["a"])(T,E,U,!1,null,"b91f789c",null)),H=A.exports,q={name:"Messenger",components:{Message:j,Dialog:H,ModelSelect:x["ModelSelect"]},data:function(){return{draftMessage:"",item:{value:""},currentDialogId:null}},computed:{messages:function(){return this.$store.getters.messagesOfDialog(this.currentDialogId)},username:function(){return this.$store.state.username||""},dialogs:function(){return this.$store.getters.dialogsList||[]},options:function(){return null!==this.$store.state.usersList?this.$store.state.usersList.map(function(t){return{value:t.username,text:t.username}}):[{value:"",text:""}]}},methods:{onDialogSelect:function(t){console.log("Messenger::onDialogSelect( "+t+" )"),this.currentDialogId=t},sendMessage:function(){console.log("Messenger::sendMessage() ..."),this.$store.state.socket.emit("sendMessage",{message:this.draftMessage,to:this.currentDialogId}),this.draftMessage=""}},watch:{item:function(t){""!==t&&(console.log("Value picked: ",t.text),this.$store.dispatch("setupDialog",t.text),console.log("Socket IDs of all the users:\t",this.$store.getters.usersList.map(function(t){return t.socketId})))}}},B=q,F=(s("b34a"),Object(o["a"])(B,k,w,!1,null,"1d4f5043",null)),J=F.exports;n["a"].use(u["a"]);var V=new u["a"]({mode:"history",base:"/",routes:[{path:"/",name:"home",component:p,children:[{path:"login",component:M},{path:"im",component:J}]},{path:"/about",name:"about",component:function(){return s.e("about").then(s.bind(null,"f820"))}}]}),z=(s("6762"),s("2fdb"),s("8055")),G=s("2f62");n["a"].use(G["a"]);var K=new G["a"].Store({state:{backendHost:"http://localhost",socket:null,username:null,usersList:null,dialogsList:[],currentDialogId:null,messagesList:[]},mutations:{setCurrentDialogId:function(t,e){t.currentDialogId=e},setUsername:function(t,e){t.username=e},setSocket:function(t,e){console.log("setSocket() mutation commited"),t.socket=e},setUsersList:function(t,e){console.log("setUsersList() mutation commited"),t.usersList=e},setDialogsList:function(t,e){console.log("setDialogsList() mutation commited"),t.dialogsList=e},setMessagesList:function(t,e){console.log("setMessagesList() mutation commited"),t.messagesList=e},addMessage:function(t,e){console.log("addMessage() mutation commited"),t.messagesList=[].concat(Object(P["a"])(t.messagesList),[e])}},actions:{logIn:function(t){return new Promise(function(e,s){var n=z(t.state.backendHost);n.on("newMessage",function(e){console.log("the newMessage received: ",e),_.includes(t.getters.dialogsList.map(function(t){return t.dialogId}),e.dialogId)?(console.log("the dialog already exists"),console.log("dialogsList:\n",t.getters.dialogsList)):console.log("this is a new dialog"),t.commit("addMessage",e)}),n.on("userslist",function(e){console.log("the userslist received: ",e),t.commit("setUsersList",e)}),n.on("dialogsList",function(e){console.log("the dialogsList received: ",e),t.commit("setDialogsList",e)}),t.commit("setSocket",n),t.getters.socket.emit("setUsername",t.getters.username,function(){t.getters.socket.emit("getUsersList"),e()})})},setCurrentDialogId:function(t,e){t.commit("setCurrentDialogId",e)},setUsername:function(t,e){t.commit("setUsername",e)},createSocket:function(t){console.log("createSocket() action dispatched");var e=z(t.state.backendHost);e.on("userslist",function(e){console.log("the userslist received: ",e),t.commit("setUsersList",e)}),e.on("dialogsList",function(e){console.log("the dialogsList received: ",e),t.commit("setDialogsList",e)}),t.commit("setSocket",e)},getUsersList:function(t){console.log("getUsersList() action dispatched"),t.state.socket.emit("getUsersList")},setupDialog:function(t,e){console.log("setupDialog() action dispatched /w username: ",e),t.state.socket.emit("setupDialog",t.getters.usersList.filter(function(t){return t.username===e})[0].socketId)},getDialogsList:function(t){console.log("getDialogsList() action dispatched"),t.state.socket.emit("getDialogsList")},getMessagesList:function(t){console.log("getDialogsList() action dispatched")}},getters:{messagesOfDialog:function(t){return function(e){return t.messagesList.filter(function(t){return t.dialogId===e})}},dialogsList:function(t){return t.dialogsList},usersList:function(t){return t.usersList},username:function(t){return t.username},socket:function(t){return t.socket}}}),Q=s("9483");Object(Q["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}}),n["a"].config.productionTip=!1,new n["a"]({router:V,store:K,render:function(t){return t(l)}}).$mount("#app")},"5c0b":function(t,e,s){"use strict";var n=s("5e27"),i=s.n(n);i.a},"5e27":function(t,e,s){},"892b":function(t,e,s){"use strict";var n=s("03a5"),i=s.n(n);i.a},"9ef7":function(t,e,s){"use strict";var n=s("cd88"),i=s.n(n);i.a},b34a:function(t,e,s){"use strict";var n=s("f0c4"),i=s.n(n);i.a},ba24:function(t,e,s){},cd88:function(t,e,s){},d8d7:function(t,e,s){},f0c4:function(t,e,s){},f545:function(t,e,s){"use strict";var n=s("ba24"),i=s.n(n);i.a},f7c3:function(t,e,s){"use strict";var n=s("d8d7"),i=s.n(n);i.a}});
//# sourceMappingURL=app.8becb96b.js.map